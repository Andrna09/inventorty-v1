<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div class="d-flex justify-content-between align-items-center mb-4 fade-in">
  <div>
    <h3 class="fw-bold text-primary" id="dash_greeting">Halo, Admin</h3>
    <p class="text-muted mb-0" id="dash_email">Memuat data...</p>
  </div>
  <button class="btn btn-light shadow-sm" onclick="dash_load()"><i class="material-icons">refresh</i></button>
</div>

<div class="row g-4 mb-4 fade-in">
  <div class="col-md-4">
    <div class="card border-0 shadow-sm p-3 h-100" style="border-left: 5px solid #3498db; border-radius: 12px;">
      <div class="d-flex justify-content-between">
        <div><p class="text-muted mb-1 small text-uppercase fw-bold">Total Produk</p><h2 class="fw-bold mb-0" id="dash_total_produk">0</h2></div>
        <div class="bg-light rounded-circle p-3 d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;"><i class="material-icons text-primary">inventory_2</i></div>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card border-0 shadow-sm p-3 h-100" style="border-left: 5px solid #2ecc71; border-radius: 12px;">
      <div class="d-flex justify-content-between">
        <div><p class="text-muted mb-1 small text-uppercase fw-bold">Transaksi Masuk</p><h2 class="fw-bold mb-0 text-success" id="dash_total_masuk">0</h2></div>
        <div class="bg-light rounded-circle p-3 d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;"><i class="material-icons text-success">input</i></div>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card border-0 shadow-sm p-3 h-100" style="border-left: 5px solid #e74c3c; border-radius: 12px;">
      <div class="d-flex justify-content-between">
        <div><p class="text-muted mb-1 small text-uppercase fw-bold">Transaksi Keluar</p><h2 class="fw-bold mb-0 text-danger" id="dash_total_keluar">0</h2></div>
        <div class="bg-light rounded-circle p-3 d-flex align-items-center justify-content-center" style="width: 50px; height: 50px;"><i class="material-icons text-danger">outbox</i></div>
      </div>
    </div>
  </div>
</div>

<script>
  (function() { dash_load(); })();

  function dash_load() {
    google.script.run.withSuccessHandler(function(res) {
      if(res.success) {
        var d = res.data;
        document.getElementById('dash_greeting').innerText = d.greeting;
        document.getElementById('dash_email').innerText = d.userEmail;
        document.getElementById('dash_total_produk').innerText = d.totalProduk;
        document.getElementById('dash_total_masuk').innerText = d.totalMasuk;
        document.getElementById('dash_total_keluar').innerText = d.totalKeluar;
      }
    }).getDashboardData();
  }
</script>
